var WalkthroughCamera=pc.createScript("walkthroughCamera");WalkthroughCamera.attributes.add("movementSpeed",{type:"number",default:5}),WalkthroughCamera.attributes.add("lookSpeed",{type:"number",default:.2}),WalkthroughCamera.prototype.initialize=function(){this.eulers=new pc.Vec3,this.initialHeight=this.entity.getPosition().y,this.app.mouse.on(pc.EVENT_MOUSEDOWN,(function(e){this.app.mouse.enablePointerLock()}),this),this.eulers.copy(this.entity.getLocalEulerAngles()),this.app.mouse.on(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),this.app.keyboard.on(pc.EVENT_KEYDOWN,this.onKeyDown,this),this.app.keyboard.on(pc.EVENT_KEYUP,this.onKeyUp,this),this.moveForward=!1,this.moveBackward=!1,this.moveLeft=!1,this.moveRight=!1},WalkthroughCamera.prototype.update=function(e){var t=this.entity.forward,i=this.entity.right,o=new pc.Vec3;this.moveForward&&o.add(t),this.moveBackward&&o.sub(t),this.moveLeft&&o.sub(i),this.moveRight&&o.add(i),o.normalize().scale(this.movementSpeed*e);var s=this.entity.getPosition().clone();s.add(o),s.y=this.initialHeight,this.entity.setPosition(s),this.entity.setLocalEulerAngles(this.eulers.x,this.eulers.y,0)},WalkthroughCamera.prototype.onMouseMove=function(e){pc.Mouse.isPointerLocked()&&(this.eulers.x-=e.dy*this.lookSpeed,this.eulers.y-=e.dx*this.lookSpeed,this.eulers.x=pc.math.clamp(this.eulers.x,-90,90))},WalkthroughCamera.prototype.onKeyDown=function(e){e.key===pc.KEY_W?this.moveForward=!0:e.key===pc.KEY_S?this.moveBackward=!0:e.key===pc.KEY_A?this.moveLeft=!0:e.key===pc.KEY_D&&(this.moveRight=!0)},WalkthroughCamera.prototype.onKeyUp=function(e){e.key===pc.KEY_W?this.moveForward=!1:e.key===pc.KEY_S?this.moveBackward=!1:e.key===pc.KEY_A?this.moveLeft=!1:e.key===pc.KEY_D&&(this.moveRight=!1)};var MicroscopeAnimation=pc.createScript("microscopeAnimation");MicroscopeAnimation.prototype.initialize=function(){this.currentStateIndex=0,this.imageEntity=this.app.root.findByName("ResultImage"),this.imageEntity.enabled=!1,this.app.keyboard.on(pc.EVENT_KEYDOWN,this.onKeyDown,this)},MicroscopeAnimation.prototype.onKeyDown=function(t){t.key===pc.KEY_SPACE&&this.handleSpacePress()},MicroscopeAnimation.prototype.handleSpacePress=function(){this.currentStateIndex<5?(this.playAnimation(this.currentStateIndex),this.currentStateIndex++):5===this.currentStateIndex?(this.displayImage(),this.currentStateIndex++):(this.hideImage(),this.currentStateIndex=0)},MicroscopeAnimation.prototype.playAnimation=function(t){console.log("Playing animation for state index:",t);var e=this.app.root.findByName("Microscope");if(e&&e.animation)switch(t){case 0:e.animation.play("Idle");break;case 1:e.animation.play("EyeglassPlacement");break;case 2:e.animation.play("KnobAdjustment");break;case 3:e.animation.play("EyeRotate");break;case 4:e.animation.play("FineAdjustment");break;default:console.warn("No animation defined for state index:",t)}else console.warn("Microscope entity or animation component not found.")},MicroscopeAnimation.prototype.displayImage=function(){this.imageEntity.enabled=!0,console.log("Image displayed.")},MicroscopeAnimation.prototype.hideImage=function(){this.imageEntity.enabled=!1,console.log("Image hidden.")},MicroscopeAnimation.prototype.destroy=function(){this.app.keyboard.off(pc.EVENT_KEYDOWN,this.onKeyDown,this)};